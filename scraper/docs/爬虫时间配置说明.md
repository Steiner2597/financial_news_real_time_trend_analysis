# çˆ¬è™«æ—¶é—´é…ç½®è¯´æ˜

## ğŸ“‹ é…ç½®æ–‡ä»¶ä½ç½®

`scraper/config.yaml` ä¸­çš„ `crawler_control` éƒ¨åˆ†

## âš™ï¸ é…ç½®ç»“æ„

```yaml
crawler_control:
  # ä¸»å¾ªç¯é—´éš”ï¼ˆç§’ï¼‰
  loop_interval: 300  # æ‰€æœ‰çˆ¬è™«ä¸€èµ·æ£€æŸ¥çš„é—´éš”
  
  # å„çˆ¬è™«ç‹¬ç«‹é—´éš”ï¼ˆç§’ï¼‰
  individual_intervals:
    reddit: 300
    newsapi: 900
    rss: 300
    stocktwits: 300
    twitter: 1800
    alphavantage: 900
  
  # è¯·æ±‚å»¶è¿Ÿï¼ˆç§’ï¼‰
  request_delays:
    reddit: 0.5
    newsapi: 1
    rss: 1
    stocktwits: 1
    twitter: 2
    alphavantage: 12
```

## ğŸ¯ é…ç½®è¯´æ˜

### 1. loop_interval (ä¸»å¾ªç¯é—´éš”)

**ä½œç”¨**: æ§åˆ¶æ•´ä¸ªçˆ¬è™«ç³»ç»Ÿå¤šä¹…æ£€æŸ¥ä¸€æ¬¡

**å½“å‰å€¼**: `300` ç§’ï¼ˆ5åˆ†é’Ÿï¼‰

**å·¥ä½œåŸç†**:
- æ¯éš” 300 ç§’ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥æ‰€æœ‰çˆ¬è™«
- ç»“åˆ `individual_intervals` å†³å®šæ˜¯å¦çœŸæ­£è¿è¡ŒæŸä¸ªçˆ¬è™«

**å»ºè®®å€¼**:
- å¿«é€Ÿæ›´æ–°: `60-180` ç§’
- æ ‡å‡†æ¨¡å¼: `300-600` ç§’
- èŠ‚çœèµ„æº: `900-1800` ç§’

### 2. individual_intervals (ç‹¬ç«‹é—´éš”)

**ä½œç”¨**: æ§åˆ¶æ¯ä¸ªçˆ¬è™«çš„å®é™…è¿è¡Œé¢‘ç‡

**å·¥ä½œåŸç†**:
- å³ä½¿ä¸»å¾ªç¯æ¯ 5 åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿä¼šæ£€æŸ¥å•ä¸ªçˆ¬è™«æ˜¯å¦åˆ°è¾¾è¿è¡Œæ—¶é—´
- ä¾‹å¦‚: `newsapi: 900` è¡¨ç¤º NewsAPI æ¯ 15 åˆ†é’Ÿæ‰è¿è¡Œä¸€æ¬¡ï¼Œå³ä½¿ä¸»å¾ªç¯æ¯ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡

**ç¤ºä¾‹åœºæ™¯**:

```
æ—¶é—´è½´:
0:00  - ä¸»å¾ªç¯è¿è¡Œ â†’ Reddit(âœ“) NewsAPI(âœ“) RSS(âœ“) éƒ½è¿è¡Œ
0:05  - ä¸»å¾ªç¯è¿è¡Œ â†’ Reddit(âœ“) NewsAPI(âœ—) RSS(âœ“) 
        (NewsAPI è·ä¸Šæ¬¡åªæœ‰ 5 åˆ†é’Ÿï¼Œè·³è¿‡)
0:10  - ä¸»å¾ªç¯è¿è¡Œ â†’ Reddit(âœ“) NewsAPI(âœ—) RSS(âœ“)
0:15  - ä¸»å¾ªç¯è¿è¡Œ â†’ Reddit(âœ“) NewsAPI(âœ“) RSS(âœ“)
        (NewsAPI è·ä¸Šæ¬¡ 15 åˆ†é’Ÿï¼Œè¿è¡Œ)
```

**æ¨èé…ç½®**:

| çˆ¬è™« | é—´éš” | åŸå›  |
|------|------|------|
| reddit | 300s (5åˆ†é’Ÿ) | æ›´æ–°å¿«ï¼Œæ— ä¸¥æ ¼é™åˆ¶ |
| newsapi | 900s (15åˆ†é’Ÿ) | API é…é¢æœ‰é™ (100æ¬¡/å¤©) |
| rss | 300s (5åˆ†é’Ÿ) | æ›´æ–°é¢‘ç¹ï¼Œæ— é™åˆ¶ |
| stocktwits | 300s (5åˆ†é’Ÿ) | ç¤¾äº¤åª’ä½“æ›´æ–°å¿« |
| twitter | 1800s (30åˆ†é’Ÿ) | API é™åˆ¶ä¸¥æ ¼ |
| alphavantage | 900s (15åˆ†é’Ÿ) | API é…é¢æœ‰é™ (25æ¬¡/å¤©) |

### 3. request_delays (è¯·æ±‚å»¶è¿Ÿ)

**ä½œç”¨**: å•ä¸ªçˆ¬è™«å†…éƒ¨ï¼Œè¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿ

**å·¥ä½œåŸç†**:
- åœ¨çˆ¬å–å¤šä¸ªå…³é”®è¯/æºæ—¶ï¼Œæ¯ä¸ªè¯·æ±‚ä¹‹é—´ç­‰å¾…çš„æ—¶é—´
- é¿å…è§¦å‘é€Ÿç‡é™åˆ¶æˆ–è¢«å°ç¦

**ç¤ºä¾‹**:
```python
# Reddit çˆ¬è™«ä¼šè¿™æ ·å·¥ä½œ:
for subreddit in ['investing', 'stocks', 'wallstreetbets']:
    fetch_data(subreddit)
    time.sleep(0.5)  # ä½¿ç”¨ request_delays.reddit
```

**æ¨èå€¼**:
- å®½æ¾é™åˆ¶: `0.5-1` ç§’
- ä¸­ç­‰é™åˆ¶: `1-2` ç§’
- ä¸¥æ ¼é™åˆ¶: `2-5` ç§’
- ç‰¹æ®Šæƒ…å†µ: `10+` ç§’ (å¦‚ AlphaVantage)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1: ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰

ç›´æ¥ä¿®æ”¹ `config.yaml`ï¼Œç„¶åè¿è¡Œ:

```bash
cd scraper
python control_center.py --loop
```

ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ `loop_interval: 300`

### æ–¹å¼ 2: å‘½ä»¤è¡Œè¦†ç›–

ä¸´æ—¶ä¿®æ”¹ä¸»å¾ªç¯é—´éš”ï¼ˆä¸å½±å“ç‹¬ç«‹é—´éš”ï¼‰:

```bash
# æ¯ 60 ç§’è¿è¡Œä¸€æ¬¡
python control_center.py --loop --interval 60

# æ¯ 10 åˆ†é’Ÿè¿è¡Œä¸€æ¬¡
python control_center.py --loop --interval 600
```

### æ–¹å¼ 3: å•æ¬¡è¿è¡Œ

ä¸ä½¿ç”¨å¾ªç¯ï¼Œåªè¿è¡Œä¸€æ¬¡:

```bash
python control_center.py
```

## ğŸ“Š å®é™…è¿è¡Œç¤ºä¾‹

**é…ç½®**:
```yaml
crawler_control:
  loop_interval: 300
  individual_intervals:
    reddit: 300
    newsapi: 900
    rss: 300
```

**è¿è¡Œæ—¥å¿—**:
```
============================================================
å¯åŠ¨å¾ªç¯æ¨¡å¼ - é—´éš”: 300 ç§’ (5.0 åˆ†é’Ÿ)

ç‹¬ç«‹é—´éš”æ§åˆ¶:
  newsapi        :  900 ç§’ (15.0 åˆ†é’Ÿ)

æŒ‰ Ctrl+C åœæ­¢
============================================================

============================================================
ç¬¬ 1 æ¬¡è¿è¡Œ - 2025-11-01 14:00:00
============================================================

âœ“ Reddit çˆ¬è™«è¿è¡Œ
âœ“ NewsAPI çˆ¬è™«è¿è¡Œ
âœ“ RSS çˆ¬è™«è¿è¡Œ

============================================================
ç¬¬ 2 æ¬¡è¿è¡Œ - 2025-11-01 14:05:00
============================================================

âœ“ Reddit çˆ¬è™«è¿è¡Œ
â­ï¸  NEWSAPI - è·³è¿‡ï¼ˆè·ä¸Šæ¬¡è¿è¡Œ 300ç§’ï¼Œé—´éš” 900ç§’ï¼‰
âœ“ RSS çˆ¬è™«è¿è¡Œ

============================================================
ç¬¬ 3 æ¬¡è¿è¡Œ - 2025-11-01 14:10:00
============================================================

âœ“ Reddit çˆ¬è™«è¿è¡Œ
â­ï¸  NEWSAPI - è·³è¿‡ï¼ˆè·ä¸Šæ¬¡è¿è¡Œ 600ç§’ï¼Œé—´éš” 900ç§’ï¼‰
âœ“ RSS çˆ¬è™«è¿è¡Œ

============================================================
ç¬¬ 4 æ¬¡è¿è¡Œ - 2025-11-01 14:15:00
============================================================

âœ“ Reddit çˆ¬è™«è¿è¡Œ
âœ“ NewsAPI çˆ¬è™«è¿è¡Œ  â† è·ä¸Šæ¬¡ 900 ç§’ï¼Œç°åœ¨è¿è¡Œ
âœ“ RSS çˆ¬è™«è¿è¡Œ
```

## ğŸ›ï¸ é…ç½®ç­–ç•¥

### ç­–ç•¥ 1: é«˜é¢‘å®æ—¶ (é€‚åˆæµ‹è¯•/æ¼”ç¤º)

```yaml
crawler_control:
  loop_interval: 60  # 1åˆ†é’Ÿ
  individual_intervals:
    reddit: 60
    newsapi: 180
    rss: 60
    stocktwits: 60
    twitter: 300
    alphavantage: 300
```

**ç‰¹ç‚¹**:
- âœ… æ•°æ®æ›´æ–°å¿«
- âœ… å®æ—¶æ€§å¥½
- âŒ API æ¶ˆè€—å¿«
- âŒ èµ„æºå ç”¨é«˜

### ç­–ç•¥ 2: æ ‡å‡†å‡è¡¡ (æ¨èç”Ÿäº§ç¯å¢ƒ)

```yaml
crawler_control:
  loop_interval: 300  # 5åˆ†é’Ÿ
  individual_intervals:
    reddit: 300
    newsapi: 900
    rss: 300
    stocktwits: 300
    twitter: 1800
    alphavantage: 900
```

**ç‰¹ç‚¹**:
- âœ… API é…é¢æŒä¹…
- âœ… èµ„æºå ç”¨é€‚ä¸­
- âœ… æ•°æ®åŠæ—¶æ€§å¥½
- âœ… å¹³è¡¡æœ€ä½³

### ç­–ç•¥ 3: ä½é¢‘çœèµ„æº

```yaml
crawler_control:
  loop_interval: 900  # 15åˆ†é’Ÿ
  individual_intervals:
    reddit: 900
    newsapi: 3600
    rss: 900
    stocktwits: 900
    twitter: 7200
    alphavantage: 3600
```

**ç‰¹ç‚¹**:
- âœ… API é…é¢èŠ‚çœ
- âœ… èµ„æºå ç”¨ä½
- âŒ å®æ—¶æ€§è¾ƒå·®
- âŒ æ•°æ®å»¶è¿Ÿé«˜

## ğŸ”§ API é…é¢è®¡ç®—

### NewsAPI (100 æ¬¡/å¤©)

**å½“å‰é…ç½®**: 900 ç§’é—´éš”

```
24å°æ—¶ = 86400 ç§’
86400 Ã· 900 = 96 æ¬¡/å¤©
```

âœ… åœ¨é…é¢å†…ï¼ˆ<100 æ¬¡ï¼‰

### AlphaVantage (25 æ¬¡/å¤©)

**å½“å‰é…ç½®**: 900 ç§’é—´éš”

```
86400 Ã· 900 = 96 æ¬¡/å¤©
```

âŒ è¶…å‡ºé…é¢ï¼åº”è¯¥è‡³å°‘ 3456 ç§’ (58åˆ†é’Ÿ)

**å»ºè®®è°ƒæ•´**:
```yaml
individual_intervals:
  alphavantage: 3600  # 1å°æ—¶ï¼Œ24æ¬¡/å¤©
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **API é…é¢**: ç¡®ä¿é—´éš”è¶³å¤Ÿé•¿ï¼Œé¿å…è¶…å‡ºé™åˆ¶
2. **ä¸»å¾ªç¯**: `loop_interval` åº”è¯¥æ˜¯æœ€å°é—´éš”çš„å…¬çº¦æ•°
3. **å»¶è¿Ÿè®¾ç½®**: `request_delays` ä¸»è¦é˜²æ­¢åŒä¸€çˆ¬è™«å†…éƒ¨çš„é€Ÿç‡é™åˆ¶
4. **ç‹¬ç«‹é—´éš”**: è®¾ä¸º 0 æˆ– null è¡¨ç¤ºè·Ÿéšä¸»å¾ªç¯
5. **é‡å¯ç”Ÿæ•ˆ**: ä¿®æ”¹é…ç½®åéœ€è¦é‡å¯ control_center

## ğŸ†˜ æ•…éšœæ’é™¤

### é—®é¢˜ 1: çˆ¬è™«è¿è¡Œå¤ªé¢‘ç¹

**ç°è±¡**: API é…é¢å¾ˆå¿«ç”¨å®Œ

**è§£å†³**: å¢å¤§ `individual_intervals` ä¸­çš„å€¼

### é—®é¢˜ 2: çˆ¬è™«æ€»æ˜¯è¢«è·³è¿‡

**ç°è±¡**: æ—¥å¿—æ˜¾ç¤º "â­ï¸ è·³è¿‡"

**åŸå› **: `individual_intervals` å¤ªå¤§ï¼Œæˆ–åˆšå¯åŠ¨

**è§£å†³**: 
- å‡å°é—´éš”å€¼
- ç­‰å¾…è¶³å¤Ÿæ—¶é—´

### é—®é¢˜ 3: æ•°æ®æ›´æ–°å¤ªæ…¢

**ç°è±¡**: å‰ç«¯æ˜¾ç¤ºæ•°æ®ä¸å¤Ÿå®æ—¶

**è§£å†³**: 
- å‡å° `loop_interval`
- å‡å° `individual_intervals`
- ä½†æ³¨æ„ API é…é¢

## ğŸ“ˆ ç›‘æ§å»ºè®®

å¯åŠ¨æ—¶ä¼šæ˜¾ç¤º:

```
ç‹¬ç«‹é—´éš”æ§åˆ¶:
  reddit         :  300 ç§’ (5.0 åˆ†é’Ÿ)
  newsapi        :  900 ç§’ (15.0 åˆ†é’Ÿ)
  rss            :  300 ç§’ (5.0 åˆ†é’Ÿ)
  stocktwits     :  300 ç§’ (5.0 åˆ†é’Ÿ)
  twitter        : 1800 ç§’ (30.0 åˆ†é’Ÿ)
  alphavantage   :  900 ç§’ (15.0 åˆ†é’Ÿ)
```

è¿è¡Œä¸­ä¼šæ˜¾ç¤ºè·³è¿‡çš„çˆ¬è™«:

```
â­ï¸  NEWSAPI - è·³è¿‡ï¼ˆè·ä¸Šæ¬¡è¿è¡Œ 300ç§’ï¼Œé—´éš” 900ç§’ï¼‰
```

å®šæœŸæ£€æŸ¥ API ä½¿ç”¨æƒ…å†µã€‚
