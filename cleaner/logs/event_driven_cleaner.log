2025-11-01 21:14:08,369 [INFO] ======================================================================
2025-11-01 21:14:08,370 [INFO] 事件驱动清洗器初始化
2025-11-01 21:14:08,370 [INFO] ======================================================================
2025-11-01 21:14:08,370 [INFO] 模式: event_driven
2025-11-01 21:14:08,371 [INFO] 监听频道: crawler_complete (启用: True)
2025-11-01 21:14:08,371 [INFO] 发送频道: cleaner_complete (启用: True)
2025-11-01 21:14:08,371 [INFO] ----------------------------------------------------------------------
2025-11-01 21:14:08,372 [INFO] 去重模式: time_window
2025-11-01 21:14:08,372 [INFO] 时间窗口: 0.01 小时
2025-11-01 21:14:08,372 [INFO] 启动时清空: 否
2025-11-01 21:14:08,372 [INFO] ======================================================================
2025-11-01 21:14:08,372 [INFO] 
======================================================================
2025-11-01 21:14:08,372 [INFO] 🎧 事件驱动数据清洗器已就绪
2025-11-01 21:14:08,372 [INFO] ======================================================================
2025-11-01 21:14:08,374 [INFO] 监听频道: crawler_complete
2025-11-01 21:14:08,374 [INFO] 发送频道: cleaner_complete
2025-11-01 21:14:08,374 [INFO] 按 Ctrl+C 停止
2025-11-01 21:14:08,374 [INFO] ======================================================================

2025-11-01 21:14:08,383 [INFO] ✓ Redis 订阅连接成功: localhost:6379/DB0
2025-11-01 21:14:08,384 [INFO] ✓ 已订阅频道: crawler_complete
2025-11-01 21:14:08,386 [INFO] ✓ Redis 发送连接成功: localhost:6379/DB1
2025-11-01 21:22:55,082 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 21:22:55,082 [INFO]   状态: 空（未初始化）
2025-11-01 21:22:55,084 [INFO] 
======================================================================
2025-11-01 21:22:55,084 [INFO] 📬 收到爬虫完成通知
2025-11-01 21:22:55,084 [INFO] ======================================================================
2025-11-01 21:22:55,084 [INFO] 事件类型: crawl_complete
2025-11-01 21:22:55,084 [INFO] 时间戳: 2025-11-01T21:22:55.079849
2025-11-01 21:22:55,084 [INFO] 总数据量: 6275
2025-11-01 21:22:55,084 [INFO] 队列长度: 6275
2025-11-01 21:22:55,084 [INFO] ----------------------------------------------------------------------
2025-11-01 21:22:55,086 [INFO]   reddit: {'posts': 250, 'comments': 4849, 'errors': 0}
2025-11-01 21:22:55,086 [INFO]   newsapi: {'articles': 93, 'errors': 0}
2025-11-01 21:22:55,086 [INFO]   rss: {'articles': 813, 'errors': 0}
2025-11-01 21:22:55,086 [INFO]   stocktwits: {'messages': 270, 'errors': 0}
2025-11-01 21:22:55,086 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 21:22:55,086 [INFO] ======================================================================
2025-11-01 21:22:55,087 [INFO] 🚀 开始执行数据清洗...
2025-11-01 21:22:55,087 [INFO] ======================================================================
2025-11-01 21:22:55,087 [INFO] 
🧹 开始单次清洗...
2025-11-01 21:22:55,088 [INFO] 📊 待清洗数据量: 6275
2025-11-01 21:22:55,102 [INFO] 进度: 100/6275 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 21:22:55,115 [INFO] 进度: 200/6275 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 21:22:55,125 [INFO] 进度: 300/6275 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 21:22:55,145 [INFO] 进度: 400/6275 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 21:22:55,156 [INFO] 进度: 500/6275 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 21:22:55,169 [INFO] 进度: 600/6275 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 21:22:55,187 [INFO] 进度: 700/6275 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 21:22:55,201 [INFO] 进度: 800/6275 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 21:22:55,215 [INFO] 进度: 900/6275 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 21:22:55,229 [INFO] 进度: 1000/6275 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 21:22:55,242 [INFO] 进度: 1100/6275 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 21:22:55,255 [INFO] 进度: 1200/6275 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 21:22:55,269 [INFO] 进度: 1300/6275 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 21:22:55,282 [INFO] 进度: 1400/6275 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 21:22:55,296 [INFO] 进度: 1500/6275 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 21:22:55,309 [INFO] 进度: 1600/6275 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 21:22:55,323 [INFO] 进度: 1700/6275 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 21:22:55,337 [INFO] 进度: 1800/6275 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 21:22:55,350 [INFO] 进度: 1900/6275 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 21:22:55,363 [INFO] 进度: 2000/6275 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 21:22:55,377 [INFO] 进度: 2100/6275 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 21:22:55,392 [INFO] 进度: 2200/6275 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 21:22:55,405 [INFO] 进度: 2300/6275 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 21:22:55,420 [INFO] 进度: 2400/6275 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 21:22:55,433 [INFO] 进度: 2500/6275 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 21:22:55,446 [INFO] 进度: 2600/6275 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 21:22:55,460 [INFO] 进度: 2700/6275 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 21:22:55,473 [INFO] 进度: 2800/6275 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 21:22:55,487 [INFO] 进度: 2900/6275 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 21:22:55,500 [INFO] 进度: 3000/6275 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 21:22:55,513 [INFO] 进度: 3100/6275 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 21:22:55,527 [INFO] 进度: 3200/6275 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 21:22:55,541 [INFO] 进度: 3300/6275 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 21:22:55,554 [INFO] 进度: 3400/6275 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 21:22:55,567 [INFO] 进度: 3500/6275 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 21:22:55,583 [INFO] 进度: 3600/6275 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 21:22:55,597 [INFO] 进度: 3700/6275 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 21:22:55,611 [INFO] 进度: 3800/6275 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 21:22:55,625 [INFO] 进度: 3900/6275 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 21:22:55,640 [INFO] 进度: 4000/6275 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 21:22:55,653 [INFO] 进度: 4100/6275 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 21:22:55,666 [INFO] 进度: 4200/6275 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 21:22:55,681 [INFO] 进度: 4300/6275 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 21:22:55,693 [INFO] 进度: 4400/6275 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 21:22:55,707 [INFO] 进度: 4500/6275 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 21:22:55,719 [INFO] 进度: 4600/6275 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 21:22:55,733 [INFO] 进度: 4700/6275 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 21:22:55,747 [INFO] 进度: 4800/6275 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 21:22:55,760 [INFO] 进度: 4900/6275 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 21:22:55,773 [INFO] 进度: 5000/6275 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 21:22:55,789 [INFO] 进度: 5100/6275 (清洗: 1, 去重: 0, 无效: 5099)
2025-11-01 21:22:55,874 [INFO] 进度: 5200/6275 (清洗: 84, 去重: 9, 无效: 5107)
2025-11-01 21:22:55,888 [INFO] 进度: 5300/6275 (清洗: 84, 去重: 9, 无效: 5207)
2025-11-01 21:22:55,941 [INFO] 进度: 5400/6275 (清洗: 94, 去重: 9, 无效: 5297)
2025-11-01 21:22:55,955 [INFO] 进度: 5500/6275 (清洗: 94, 去重: 9, 无效: 5397)
2025-11-01 21:22:55,969 [INFO] 进度: 5600/6275 (清洗: 94, 去重: 9, 无效: 5497)
2025-11-01 21:22:56,001 [INFO] 进度: 5700/6275 (清洗: 94, 去重: 9, 无效: 5597)
2025-11-01 21:22:56,015 [INFO] 进度: 5800/6275 (清洗: 94, 去重: 9, 无效: 5697)
2025-11-01 21:22:56,030 [INFO] 进度: 5900/6275 (清洗: 94, 去重: 9, 无效: 5797)
2025-11-01 21:22:56,053 [INFO] 进度: 6000/6275 (清洗: 100, 去重: 9, 无效: 5891)
2025-11-01 21:22:56,066 [INFO] 进度: 6100/6275 (清洗: 100, 去重: 9, 无效: 5991)
2025-11-01 21:22:56,083 [INFO] 进度: 6200/6275 (清洗: 100, 去重: 9, 无效: 6091)
2025-11-01 21:22:56,100 [INFO] 进度: 6275/6275 (清洗: 100, 去重: 9, 无效: 6166)
2025-11-01 21:22:56,100 [INFO] 
✨ 单次清洗完成
2025-11-01 21:22:56,101 [INFO] 总处理: 6275
2025-11-01 21:22:56,101 [INFO] 清洗成功: 100
2025-11-01 21:22:56,101 [INFO] 去重过滤: 9
2025-11-01 21:22:56,101 [INFO] 无效数据: 6166
2025-11-01 21:22:56,101 [INFO] 
📦 导出清洗结果到文件...
2025-11-01 21:22:56,102 [INFO] 📦 导出 100 条数据到文件...
2025-11-01 21:22:56,128 [INFO] ✅ 数据已导出到: D:\SE\workspace\financial_real_time_trend_analysis\cleaner\output\cleaned_2025-11-01.jsonl
2025-11-01 21:22:56,129 [INFO] 📊 清洗完成，共处理 100 条数据
2025-11-01 21:22:56,130 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 21:22:56,130 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 21:22:56,130 [INFO]   总 ID 数: 100
2025-11-01 21:22:56,130 [INFO]   有效 ID: 100
2025-11-01 21:22:56,130 [INFO]   过期 ID: 0
2025-11-01 21:22:56,130 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 21:22:56,132 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 21:22:56,132 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 21:22:56,134 [INFO] ======================================================================
2025-11-01 21:22:56,134 [INFO] ✨ 数据清洗完成
2025-11-01 21:22:56,135 [INFO] ======================================================================

2025-11-01 21:34:52,871 [INFO] 

⚠️  收到退出信号 (SIGINT)，正在优雅关闭...
2025-11-01 21:34:52,871 [INFO] 
======================================================================
2025-11-01 21:34:52,872 [INFO] 🧹 清理资源...
2025-11-01 21:34:52,872 [INFO] 
🧹 清理 Redis 连接...
2025-11-01 21:34:52,872 [INFO] ✓ 已发送取消订阅请求: crawler_complete
2025-11-01 21:34:52,872 [INFO] ✓ 已断开订阅连接
2025-11-01 21:34:52,872 [INFO] ✓ Redis 订阅连接已关闭
2025-11-01 21:34:52,873 [INFO] ✓ Redis 发送连接已关闭
2025-11-01 21:34:52,873 [INFO] 👋 清洗器已停止
2025-11-01 21:34:52,873 [INFO] ======================================================================
2025-11-01 21:34:57,251 [INFO] ======================================================================
2025-11-01 21:34:57,251 [INFO] 事件驱动清洗器初始化
2025-11-01 21:34:57,251 [INFO] ======================================================================
2025-11-01 21:34:57,251 [INFO] 模式: event_driven
2025-11-01 21:34:57,251 [INFO] 监听频道: crawler_complete (启用: True)
2025-11-01 21:34:57,251 [INFO] 发送频道: cleaner_complete (启用: True)
2025-11-01 21:34:57,251 [INFO] ----------------------------------------------------------------------
2025-11-01 21:34:57,251 [INFO] 去重模式: time_window
2025-11-01 21:34:57,251 [INFO] 时间窗口: 0.01 小时
2025-11-01 21:34:57,251 [INFO] 启动时清空: 否
2025-11-01 21:34:57,251 [INFO] ======================================================================
2025-11-01 21:34:57,251 [INFO] 
======================================================================
2025-11-01 21:34:57,251 [INFO] 🎧 事件驱动数据清洗器已就绪
2025-11-01 21:34:57,251 [INFO] ======================================================================
2025-11-01 21:34:57,251 [INFO] 监听频道: crawler_complete
2025-11-01 21:34:57,262 [INFO] 发送频道: cleaner_complete
2025-11-01 21:34:57,262 [INFO] 按 Ctrl+C 停止
2025-11-01 21:34:57,262 [INFO] ======================================================================

2025-11-01 21:34:57,262 [INFO] ✓ Redis 订阅连接成功: localhost:6379/DB0
2025-11-01 21:34:57,272 [INFO] ✓ 已订阅频道: crawler_complete
2025-11-01 21:34:57,272 [INFO] ✓ Redis 发送连接成功: localhost:6379/DB1
2025-11-01 21:40:57,286 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 21:40:57,286 [INFO]   状态: 空（未初始化）
2025-11-01 21:40:57,287 [INFO] 
======================================================================
2025-11-01 21:40:57,288 [INFO] 📬 收到爬虫完成通知
2025-11-01 21:40:57,288 [INFO] ======================================================================
2025-11-01 21:40:57,288 [INFO] 事件类型: crawl_complete
2025-11-01 21:40:57,288 [INFO] 时间戳: 2025-11-01T21:40:57.274557
2025-11-01 21:40:57,288 [INFO] 总数据量: 12535
2025-11-01 21:40:57,288 [INFO] 队列长度: 6260
2025-11-01 21:40:57,288 [INFO] ----------------------------------------------------------------------
2025-11-01 21:40:57,289 [INFO]   reddit: {'posts': 500, 'comments': 9681, 'errors': 0}
2025-11-01 21:40:57,289 [INFO]   newsapi: {'articles': 188, 'errors': 0}
2025-11-01 21:40:57,289 [INFO]   rss: {'articles': 1626, 'errors': 0}
2025-11-01 21:40:57,289 [INFO]   stocktwits: {'messages': 540, 'errors': 0}
2025-11-01 21:40:57,289 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 21:40:57,289 [INFO] ======================================================================
2025-11-01 21:40:57,289 [INFO] 🚀 开始执行数据清洗...
2025-11-01 21:40:57,289 [INFO] ======================================================================
2025-11-01 21:40:57,290 [INFO] 
🧹 开始单次清洗...
2025-11-01 21:40:57,291 [INFO] 📊 待清洗数据量: 6260
2025-11-01 21:40:57,296 [INFO] 进度: 100/6260 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 21:40:57,306 [INFO] 进度: 200/6260 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 21:40:57,316 [INFO] 进度: 300/6260 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 21:40:57,325 [INFO] 进度: 400/6260 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 21:40:57,345 [INFO] 进度: 500/6260 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 21:40:57,359 [INFO] 进度: 600/6260 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 21:40:57,366 [INFO] 进度: 700/6260 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 21:40:57,376 [INFO] 进度: 800/6260 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 21:40:57,398 [INFO] 进度: 900/6260 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 21:40:57,408 [INFO] 进度: 1000/6260 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 21:40:57,417 [INFO] 进度: 1100/6260 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 21:40:57,433 [INFO] 进度: 1200/6260 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 21:40:57,448 [INFO] 进度: 1300/6260 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 21:40:57,460 [INFO] 进度: 1400/6260 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 21:40:57,468 [INFO] 进度: 1500/6260 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 21:40:57,482 [INFO] 进度: 1600/6260 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 21:40:57,500 [INFO] 进度: 1700/6260 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 21:40:57,510 [INFO] 进度: 1800/6260 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 21:40:57,519 [INFO] 进度: 1900/6260 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 21:40:57,531 [INFO] 进度: 2000/6260 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 21:40:57,540 [INFO] 进度: 2100/6260 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 21:40:57,554 [INFO] 进度: 2200/6260 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 21:40:57,569 [INFO] 进度: 2300/6260 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 21:40:57,579 [INFO] 进度: 2400/6260 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 21:40:57,590 [INFO] 进度: 2500/6260 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 21:40:57,600 [INFO] 进度: 2600/6260 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 21:40:57,613 [INFO] 进度: 2700/6260 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 21:40:57,620 [INFO] 进度: 2800/6260 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 21:40:57,633 [INFO] 进度: 2900/6260 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 21:40:57,640 [INFO] 进度: 3000/6260 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 21:40:57,653 [INFO] 进度: 3100/6260 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 21:40:57,661 [INFO] 进度: 3200/6260 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 21:40:57,671 [INFO] 进度: 3300/6260 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 21:40:57,691 [INFO] 进度: 3400/6260 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 21:40:57,701 [INFO] 进度: 3500/6260 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 21:40:57,712 [INFO] 进度: 3600/6260 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 21:40:57,722 [INFO] 进度: 3700/6260 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 21:40:57,735 [INFO] 进度: 3800/6260 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 21:40:57,744 [INFO] 进度: 3900/6260 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 21:40:57,757 [INFO] 进度: 4000/6260 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 21:40:57,763 [INFO] 进度: 4100/6260 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 21:40:57,774 [INFO] 进度: 4200/6260 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 21:40:57,785 [INFO] 进度: 4300/6260 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 21:40:57,795 [INFO] 进度: 4400/6260 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 21:40:57,805 [INFO] 进度: 4500/6260 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 21:40:57,824 [INFO] 进度: 4600/6260 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 21:40:57,834 [INFO] 进度: 4700/6260 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 21:40:57,845 [INFO] 进度: 4800/6260 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 21:40:57,855 [INFO] 进度: 4900/6260 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 21:40:57,865 [INFO] 进度: 5000/6260 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 21:40:57,892 [INFO] 进度: 5100/6260 (清洗: 17, 去重: 1, 无效: 5082)
2025-11-01 21:40:57,950 [INFO] 进度: 5200/6260 (清洗: 83, 去重: 12, 无效: 5105)
2025-11-01 21:40:57,962 [INFO] 进度: 5300/6260 (清洗: 83, 去重: 12, 无效: 5205)
2025-11-01 21:40:58,011 [INFO] 进度: 5400/6260 (清洗: 93, 去重: 12, 无效: 5295)
2025-11-01 21:40:58,025 [INFO] 进度: 5500/6260 (清洗: 93, 去重: 12, 无效: 5395)
2025-11-01 21:40:58,039 [INFO] 进度: 5600/6260 (清洗: 93, 去重: 12, 无效: 5495)
2025-11-01 21:40:58,052 [INFO] 进度: 5700/6260 (清洗: 93, 去重: 12, 无效: 5595)
2025-11-01 21:40:58,064 [INFO] 进度: 5800/6260 (清洗: 93, 去重: 12, 无效: 5695)
2025-11-01 21:40:58,068 [INFO] 进度: 5900/6260 (清洗: 93, 去重: 12, 无效: 5795)
2025-11-01 21:40:58,092 [INFO] 进度: 6000/6260 (清洗: 99, 去重: 12, 无效: 5889)
2025-11-01 21:40:58,108 [INFO] 进度: 6100/6260 (清洗: 99, 去重: 12, 无效: 5989)
2025-11-01 21:40:58,120 [INFO] 进度: 6200/6260 (清洗: 99, 去重: 12, 无效: 6089)
2025-11-01 21:40:58,120 [INFO] 进度: 6260/6260 (清洗: 99, 去重: 12, 无效: 6149)
2025-11-01 21:40:58,120 [INFO] 
✨ 单次清洗完成
2025-11-01 21:40:58,120 [INFO] 总处理: 6260
2025-11-01 21:40:58,120 [INFO] 清洗成功: 99
2025-11-01 21:40:58,120 [INFO] 去重过滤: 12
2025-11-01 21:40:58,120 [INFO] 无效数据: 6149
2025-11-01 21:40:58,120 [INFO] 
📦 导出清洗结果到文件...
2025-11-01 21:40:58,120 [INFO] 📦 导出 99 条数据到文件...
2025-11-01 21:40:58,175 [INFO] ✅ 数据已导出到: D:\SE\workspace\financial_real_time_trend_analysis\cleaner\output\cleaned_2025-11-01.jsonl
2025-11-01 21:40:58,175 [INFO] 📊 清洗完成，共处理 99 条数据
2025-11-01 21:40:58,175 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 21:40:58,175 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 21:40:58,175 [INFO]   总 ID 数: 99
2025-11-01 21:40:58,182 [INFO]   有效 ID: 99
2025-11-01 21:40:58,182 [INFO]   过期 ID: 0
2025-11-01 21:40:58,182 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 21:40:58,184 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 21:40:58,184 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 21:40:58,184 [INFO] ======================================================================
2025-11-01 21:40:58,184 [INFO] ✨ 数据清洗完成
2025-11-01 21:40:58,185 [INFO] ======================================================================

2025-11-01 21:59:20,364 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 21:59:20,364 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 21:59:20,372 [INFO]   总 ID 数: 99
2025-11-01 21:59:20,372 [INFO]   有效 ID: 0
2025-11-01 21:59:20,372 [INFO]   过期 ID: 99
2025-11-01 21:59:20,372 [INFO] 
======================================================================
2025-11-01 21:59:20,372 [INFO] 📬 收到爬虫完成通知
2025-11-01 21:59:20,372 [INFO] ======================================================================
2025-11-01 21:59:20,374 [INFO] 事件类型: crawl_complete
2025-11-01 21:59:20,374 [INFO] 时间戳: 2025-11-01T21:59:20.364994
2025-11-01 21:59:20,374 [INFO] 总数据量: 18743
2025-11-01 21:59:20,374 [INFO] 队列长度: 6208
2025-11-01 21:59:20,374 [INFO] ----------------------------------------------------------------------
2025-11-01 21:59:20,374 [INFO]   reddit: {'posts': 750, 'comments': 14461, 'errors': 0}
2025-11-01 21:59:20,374 [INFO]   newsapi: {'articles': 283, 'errors': 0}
2025-11-01 21:59:20,374 [INFO]   rss: {'articles': 2439, 'errors': 0}
2025-11-01 21:59:20,374 [INFO]   stocktwits: {'messages': 810, 'errors': 0}
2025-11-01 21:59:20,374 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 21:59:20,374 [INFO] ======================================================================
2025-11-01 21:59:20,374 [INFO] 🚀 开始执行数据清洗...
2025-11-01 21:59:20,374 [INFO] ======================================================================
2025-11-01 21:59:20,374 [INFO] 
🧹 开始单次清洗...
2025-11-01 21:59:20,377 [INFO] 📊 待清洗数据量: 6208
2025-11-01 21:59:20,390 [INFO] 进度: 100/6208 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 21:59:20,404 [INFO] 进度: 200/6208 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 21:59:20,414 [INFO] 进度: 300/6208 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 21:59:20,421 [INFO] 进度: 400/6208 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 21:59:20,438 [INFO] 进度: 500/6208 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 21:59:20,451 [INFO] 进度: 600/6208 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 21:59:20,466 [INFO] 进度: 700/6208 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 21:59:20,484 [INFO] 进度: 800/6208 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 21:59:20,498 [INFO] 进度: 900/6208 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 21:59:20,498 [INFO] 进度: 1000/6208 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 21:59:20,526 [INFO] 进度: 1100/6208 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 21:59:20,540 [INFO] 进度: 1200/6208 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 21:59:20,552 [INFO] 进度: 1300/6208 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 21:59:20,567 [INFO] 进度: 1400/6208 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 21:59:20,581 [INFO] 进度: 1500/6208 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 21:59:20,583 [INFO] 进度: 1600/6208 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 21:59:20,607 [INFO] 进度: 1700/6208 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 21:59:20,613 [INFO] 进度: 1800/6208 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 21:59:20,627 [INFO] 进度: 1900/6208 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 21:59:20,641 [INFO] 进度: 2000/6208 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 21:59:20,658 [INFO] 进度: 2100/6208 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 21:59:20,673 [INFO] 进度: 2200/6208 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 21:59:20,688 [INFO] 进度: 2300/6208 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 21:59:20,690 [INFO] 进度: 2400/6208 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 21:59:20,715 [INFO] 进度: 2500/6208 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 21:59:20,721 [INFO] 进度: 2600/6208 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 21:59:20,738 [INFO] 进度: 2700/6208 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 21:59:20,754 [INFO] 进度: 2800/6208 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 21:59:20,758 [INFO] 进度: 2900/6208 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 21:59:20,773 [INFO] 进度: 3000/6208 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 21:59:20,786 [INFO] 进度: 3100/6208 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 21:59:20,800 [INFO] 进度: 3200/6208 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 21:59:20,821 [INFO] 进度: 3300/6208 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 21:59:20,835 [INFO] 进度: 3400/6208 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 21:59:20,848 [INFO] 进度: 3500/6208 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 21:59:20,862 [INFO] 进度: 3600/6208 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 21:59:20,874 [INFO] 进度: 3700/6208 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 21:59:20,888 [INFO] 进度: 3800/6208 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 21:59:20,888 [INFO] 进度: 3900/6208 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 21:59:20,904 [INFO] 进度: 4000/6208 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 21:59:20,920 [INFO] 进度: 4100/6208 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 21:59:20,942 [INFO] 进度: 4200/6208 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 21:59:20,954 [INFO] 进度: 4300/6208 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 21:59:20,968 [INFO] 进度: 4400/6208 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 21:59:20,983 [INFO] 进度: 4500/6208 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 21:59:20,996 [INFO] 进度: 4600/6208 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 21:59:21,009 [INFO] 进度: 4700/6208 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 21:59:21,016 [INFO] 进度: 4800/6208 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 21:59:21,033 [INFO] 进度: 4900/6208 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 21:59:21,049 [INFO] 进度: 5000/6208 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 21:59:21,081 [INFO] 进度: 5100/6208 (清洗: 9, 去重: 61, 无效: 5030)
2025-11-01 21:59:21,095 [INFO] 进度: 5200/6208 (清洗: 12, 去重: 83, 无效: 5105)
2025-11-01 21:59:21,129 [INFO] 进度: 5300/6208 (清洗: 12, 去重: 93, 无效: 5195)
2025-11-01 21:59:21,144 [INFO] 进度: 5400/6208 (清洗: 12, 去重: 93, 无效: 5295)
2025-11-01 21:59:21,161 [INFO] 进度: 5500/6208 (清洗: 12, 去重: 93, 无效: 5395)
2025-11-01 21:59:21,174 [INFO] 进度: 5600/6208 (清洗: 12, 去重: 93, 无效: 5495)
2025-11-01 21:59:21,188 [INFO] 进度: 5700/6208 (清洗: 12, 去重: 93, 无效: 5595)
2025-11-01 21:59:21,190 [INFO] 进度: 5800/6208 (清洗: 12, 去重: 93, 无效: 5695)
2025-11-01 21:59:21,216 [INFO] 进度: 5900/6208 (清洗: 12, 去重: 99, 无效: 5789)
2025-11-01 21:59:21,232 [INFO] 进度: 6000/6208 (清洗: 12, 去重: 99, 无效: 5889)
2025-11-01 21:59:21,244 [INFO] 进度: 6100/6208 (清洗: 12, 去重: 99, 无效: 5989)
2025-11-01 21:59:21,259 [INFO] 进度: 6200/6208 (清洗: 12, 去重: 99, 无效: 6089)
2025-11-01 21:59:21,259 [INFO] 进度: 6208/6208 (清洗: 12, 去重: 99, 无效: 6097)
2025-11-01 21:59:21,259 [INFO] 
✨ 单次清洗完成
2025-11-01 21:59:21,259 [INFO] 总处理: 6208
2025-11-01 21:59:21,259 [INFO] 清洗成功: 12
2025-11-01 21:59:21,259 [INFO] 去重过滤: 99
2025-11-01 21:59:21,259 [INFO] 无效数据: 6097
2025-11-01 21:59:21,259 [INFO] 
📦 导出清洗结果到文件...
2025-11-01 21:59:21,259 [INFO] 📦 导出 12 条数据到文件...
2025-11-01 21:59:21,259 [INFO] ✅ 数据已导出到: D:\SE\workspace\financial_real_time_trend_analysis\cleaner\output\cleaned_2025-11-01.jsonl
2025-11-01 21:59:21,259 [INFO] 📊 清洗完成，共处理 12 条数据
2025-11-01 21:59:21,259 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 21:59:21,259 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 21:59:21,259 [INFO]   总 ID 数: 111
2025-11-01 21:59:21,259 [INFO]   有效 ID: 12
2025-11-01 21:59:21,259 [INFO]   过期 ID: 99
2025-11-01 21:59:21,259 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 21:59:21,267 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 21:59:21,267 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 21:59:21,267 [INFO] ======================================================================
2025-11-01 21:59:21,267 [INFO] ✨ 数据清洗完成
2025-11-01 21:59:21,270 [INFO] ======================================================================

2025-11-01 22:17:25,462 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 22:17:25,462 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 22:17:25,463 [INFO]   总 ID 数: 111
2025-11-01 22:17:25,464 [INFO]   有效 ID: 0
2025-11-01 22:17:25,464 [INFO]   过期 ID: 111
2025-11-01 22:17:25,464 [INFO] 
======================================================================
2025-11-01 22:17:25,464 [INFO] 📬 收到爬虫完成通知
2025-11-01 22:17:25,464 [INFO] ======================================================================
2025-11-01 22:17:25,464 [INFO] 事件类型: crawl_complete
2025-11-01 22:17:25,465 [INFO] 时间戳: 2025-11-01T22:17:25.460662
2025-11-01 22:17:25,465 [INFO] 总数据量: 24955
2025-11-01 22:17:25,465 [INFO] 队列长度: 6212
2025-11-01 22:17:25,465 [INFO] ----------------------------------------------------------------------
2025-11-01 22:17:25,465 [INFO]   reddit: {'posts': 1000, 'comments': 19243, 'errors': 0}
2025-11-01 22:17:25,465 [INFO]   newsapi: {'articles': 380, 'errors': 0}
2025-11-01 22:17:25,465 [INFO]   rss: {'articles': 3252, 'errors': 0}
2025-11-01 22:17:25,465 [INFO]   stocktwits: {'messages': 1080, 'errors': 0}
2025-11-01 22:17:25,466 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 22:17:25,466 [INFO] ======================================================================
2025-11-01 22:17:25,466 [INFO] 🚀 开始执行数据清洗...
2025-11-01 22:17:25,466 [INFO] ======================================================================
2025-11-01 22:17:25,466 [INFO] 
🧹 开始单次清洗...
2025-11-01 22:17:25,469 [INFO] 📊 待清洗数据量: 6212
2025-11-01 22:17:25,485 [INFO] 进度: 100/6212 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 22:17:25,501 [INFO] 进度: 200/6212 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 22:17:25,517 [INFO] 进度: 300/6212 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 22:17:25,533 [INFO] 进度: 400/6212 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 22:17:25,550 [INFO] 进度: 500/6212 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 22:17:25,567 [INFO] 进度: 600/6212 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 22:17:25,583 [INFO] 进度: 700/6212 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 22:17:25,600 [INFO] 进度: 800/6212 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 22:17:25,615 [INFO] 进度: 900/6212 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 22:17:25,631 [INFO] 进度: 1000/6212 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 22:17:25,646 [INFO] 进度: 1100/6212 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 22:17:25,663 [INFO] 进度: 1200/6212 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 22:17:25,681 [INFO] 进度: 1300/6212 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 22:17:25,698 [INFO] 进度: 1400/6212 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 22:17:25,707 [INFO] 进度: 1500/6212 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 22:17:25,719 [INFO] 进度: 1600/6212 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 22:17:25,739 [INFO] 进度: 1700/6212 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 22:17:25,748 [INFO] 进度: 1800/6212 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 22:17:25,768 [INFO] 进度: 1900/6212 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 22:17:25,785 [INFO] 进度: 2000/6212 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 22:17:25,798 [INFO] 进度: 2100/6212 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 22:17:25,809 [INFO] 进度: 2200/6212 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 22:17:25,829 [INFO] 进度: 2300/6212 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 22:17:25,840 [INFO] 进度: 2400/6212 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 22:17:25,849 [INFO] 进度: 2500/6212 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 22:17:25,871 [INFO] 进度: 2600/6212 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 22:17:25,885 [INFO] 进度: 2700/6212 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 22:17:25,901 [INFO] 进度: 2800/6212 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 22:17:25,911 [INFO] 进度: 2900/6212 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 22:17:25,932 [INFO] 进度: 3000/6212 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 22:17:25,943 [INFO] 进度: 3100/6212 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 22:17:25,953 [INFO] 进度: 3200/6212 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 22:17:25,972 [INFO] 进度: 3300/6212 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 22:17:25,985 [INFO] 进度: 3400/6212 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 22:17:26,003 [INFO] 进度: 3500/6212 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 22:17:26,014 [INFO] 进度: 3600/6212 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 22:17:26,035 [INFO] 进度: 3700/6212 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 22:17:26,044 [INFO] 进度: 3800/6212 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 22:17:26,054 [INFO] 进度: 3900/6212 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 22:17:26,075 [INFO] 进度: 4000/6212 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 22:17:26,086 [INFO] 进度: 4100/6212 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 22:17:26,105 [INFO] 进度: 4200/6212 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 22:17:26,115 [INFO] 进度: 4300/6212 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 22:17:26,136 [INFO] 进度: 4400/6212 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 22:17:26,146 [INFO] 进度: 4500/6212 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 22:17:26,165 [INFO] 进度: 4600/6212 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 22:17:26,180 [INFO] 进度: 4700/6212 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 22:17:26,194 [INFO] 进度: 4800/6212 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 22:17:26,209 [INFO] 进度: 4900/6212 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 22:17:26,223 [INFO] 进度: 5000/6212 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 22:17:26,270 [INFO] 进度: 5100/6212 (清洗: 16, 去重: 52, 无效: 5032)
2025-11-01 22:17:26,286 [INFO] 进度: 5200/6212 (清洗: 20, 去重: 77, 无效: 5103)
2025-11-01 22:17:26,318 [INFO] 进度: 5300/6212 (清洗: 20, 去重: 87, 无效: 5193)
2025-11-01 22:17:26,327 [INFO] 进度: 5400/6212 (清洗: 20, 去重: 87, 无效: 5293)
2025-11-01 22:17:26,347 [INFO] 进度: 5500/6212 (清洗: 20, 去重: 87, 无效: 5393)
2025-11-01 22:17:26,357 [INFO] 进度: 5600/6212 (清洗: 20, 去重: 87, 无效: 5493)
2025-11-01 22:17:26,379 [INFO] 进度: 5700/6212 (清洗: 20, 去重: 87, 无效: 5593)
2025-11-01 22:17:26,388 [INFO] 进度: 5800/6212 (清洗: 20, 去重: 87, 无效: 5693)
2025-11-01 22:17:26,412 [INFO] 进度: 5900/6212 (清洗: 20, 去重: 93, 无效: 5787)
2025-11-01 22:17:26,426 [INFO] 进度: 6000/6212 (清洗: 20, 去重: 93, 无效: 5887)
2025-11-01 22:17:26,438 [INFO] 进度: 6100/6212 (清洗: 20, 去重: 93, 无效: 5987)
2025-11-01 22:17:26,450 [INFO] 进度: 6200/6212 (清洗: 20, 去重: 93, 无效: 6087)
2025-11-01 22:17:26,457 [INFO] 进度: 6212/6212 (清洗: 20, 去重: 93, 无效: 6099)
2025-11-01 22:17:26,457 [INFO] 
✨ 单次清洗完成
2025-11-01 22:17:26,457 [INFO] 总处理: 6212
2025-11-01 22:17:26,457 [INFO] 清洗成功: 20
2025-11-01 22:17:26,457 [INFO] 去重过滤: 93
2025-11-01 22:17:26,457 [INFO] 无效数据: 6099
2025-11-01 22:17:26,457 [INFO] 
📦 导出清洗结果到文件...
2025-11-01 22:17:26,457 [INFO] 📦 导出 20 条数据到文件...
2025-11-01 22:17:26,457 [INFO] ✅ 数据已导出到: D:\SE\workspace\financial_real_time_trend_analysis\cleaner\output\cleaned_2025-11-01.jsonl
2025-11-01 22:17:26,457 [INFO] 📊 清洗完成，共处理 20 条数据
2025-11-01 22:17:26,457 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 22:17:26,457 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 22:17:26,457 [INFO]   总 ID 数: 131
2025-11-01 22:17:26,457 [INFO]   有效 ID: 20
2025-11-01 22:17:26,457 [INFO]   过期 ID: 111
2025-11-01 22:17:26,457 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 22:17:26,457 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 22:17:26,457 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 22:17:26,457 [INFO] ======================================================================
2025-11-01 22:17:26,457 [INFO] ✨ 数据清洗完成
2025-11-01 22:17:26,457 [INFO] ======================================================================

2025-11-01 22:30:58,111 [INFO] 

⚠️  收到退出信号 (SIGINT)，正在优雅关闭...
2025-11-01 22:30:58,111 [INFO] 
======================================================================
2025-11-01 22:30:58,111 [INFO] 🧹 清理资源...
2025-11-01 22:30:58,111 [INFO] 
🧹 清理 Redis 连接...
2025-11-01 22:30:58,113 [INFO] ✓ 已发送取消订阅请求: crawler_complete
2025-11-01 22:30:58,113 [INFO] ✓ 已断开订阅连接
2025-11-01 22:30:58,113 [INFO] ✓ Redis 订阅连接已关闭
2025-11-01 22:30:58,113 [INFO] ✓ Redis 发送连接已关闭
2025-11-01 22:30:58,114 [INFO] 👋 清洗器已停止
2025-11-01 22:30:58,114 [INFO] ======================================================================
2025-11-01 22:31:02,411 [INFO] ======================================================================
2025-11-01 22:31:02,412 [INFO] 事件驱动清洗器初始化
2025-11-01 22:31:02,412 [INFO] ======================================================================
2025-11-01 22:31:02,412 [INFO] 模式: event_driven
2025-11-01 22:31:02,412 [INFO] 监听频道: crawler_complete (启用: True)
2025-11-01 22:31:02,412 [INFO] 发送频道: cleaner_complete (启用: True)
2025-11-01 22:31:02,412 [INFO] ----------------------------------------------------------------------
2025-11-01 22:31:02,414 [INFO] 去重模式: time_window
2025-11-01 22:31:02,414 [INFO] 时间窗口: 0.01 小时
2025-11-01 22:31:02,414 [INFO] 启动时清空: 否
2025-11-01 22:31:02,414 [INFO] ======================================================================
2025-11-01 22:31:02,414 [INFO] 
======================================================================
2025-11-01 22:31:02,414 [INFO] 🎧 事件驱动数据清洗器已就绪
2025-11-01 22:31:02,414 [INFO] ======================================================================
2025-11-01 22:31:02,415 [INFO] 监听频道: crawler_complete
2025-11-01 22:31:02,415 [INFO] 发送频道: cleaner_complete
2025-11-01 22:31:02,415 [INFO] 按 Ctrl+C 停止
2025-11-01 22:31:02,415 [INFO] ======================================================================

2025-11-01 22:31:02,425 [INFO] ✓ Redis 订阅连接成功: localhost:6379/DB0
2025-11-01 22:31:02,426 [INFO] ✓ 已订阅频道: crawler_complete
2025-11-01 22:31:02,427 [INFO] ✓ Redis 发送连接成功: localhost:6379/DB1
2025-11-01 22:35:47,369 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 22:35:47,369 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 22:35:47,370 [INFO]   总 ID 数: 131
2025-11-01 22:35:47,370 [INFO]   有效 ID: 0
2025-11-01 22:35:47,370 [INFO]   过期 ID: 131
2025-11-01 22:35:47,370 [INFO] 
======================================================================
2025-11-01 22:35:47,371 [INFO] 📬 收到爬虫完成通知
2025-11-01 22:35:47,371 [INFO] ======================================================================
2025-11-01 22:35:47,371 [INFO] 事件类型: crawl_complete
2025-11-01 22:35:47,371 [INFO] 时间戳: 2025-11-01T22:35:47.366641
2025-11-01 22:35:47,371 [INFO] 总数据量: 30935
2025-11-01 22:35:47,371 [INFO] 队列长度: 5980
2025-11-01 22:35:47,371 [INFO] ----------------------------------------------------------------------
2025-11-01 22:35:47,371 [INFO]   reddit: {'posts': 1250, 'comments': 23990, 'errors': 0}
2025-11-01 22:35:47,372 [INFO]   newsapi: {'articles': 380, 'errors': 5}
2025-11-01 22:35:47,372 [INFO]   rss: {'articles': 3965, 'errors': 0}
2025-11-01 22:35:47,372 [INFO]   stocktwits: {'messages': 1350, 'errors': 0}
2025-11-01 22:35:47,372 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 22:35:47,372 [INFO] ======================================================================
2025-11-01 22:35:47,372 [INFO] 🚀 开始执行数据清洗...
2025-11-01 22:35:47,372 [INFO] ======================================================================
2025-11-01 22:35:47,373 [INFO] 
🧹 开始单次清洗...
2025-11-01 22:35:47,375 [INFO] 📊 待清洗数据量: 5980
2025-11-01 22:35:47,388 [INFO] 进度: 100/5980 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 22:35:47,402 [INFO] 进度: 200/5980 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 22:35:47,415 [INFO] 进度: 300/5980 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 22:35:47,430 [INFO] 进度: 400/5980 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 22:35:47,444 [INFO] 进度: 500/5980 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 22:35:47,457 [INFO] 进度: 600/5980 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 22:35:47,470 [INFO] 进度: 700/5980 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 22:35:47,485 [INFO] 进度: 800/5980 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 22:35:47,498 [INFO] 进度: 900/5980 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 22:35:47,513 [INFO] 进度: 1000/5980 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 22:35:47,528 [INFO] 进度: 1100/5980 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 22:35:47,541 [INFO] 进度: 1200/5980 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 22:35:47,554 [INFO] 进度: 1300/5980 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 22:35:47,568 [INFO] 进度: 1400/5980 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 22:35:47,581 [INFO] 进度: 1500/5980 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 22:35:47,594 [INFO] 进度: 1600/5980 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 22:35:47,607 [INFO] 进度: 1700/5980 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 22:35:47,621 [INFO] 进度: 1800/5980 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 22:35:47,636 [INFO] 进度: 1900/5980 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 22:35:47,649 [INFO] 进度: 2000/5980 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 22:35:47,663 [INFO] 进度: 2100/5980 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 22:35:47,677 [INFO] 进度: 2200/5980 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 22:35:47,691 [INFO] 进度: 2300/5980 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 22:35:47,704 [INFO] 进度: 2400/5980 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 22:35:47,718 [INFO] 进度: 2500/5980 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 22:35:47,731 [INFO] 进度: 2600/5980 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 22:35:47,745 [INFO] 进度: 2700/5980 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 22:35:47,759 [INFO] 进度: 2800/5980 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 22:35:47,771 [INFO] 进度: 2900/5980 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 22:35:47,785 [INFO] 进度: 3000/5980 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 22:35:47,798 [INFO] 进度: 3100/5980 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 22:35:47,811 [INFO] 进度: 3200/5980 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 22:35:47,826 [INFO] 进度: 3300/5980 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 22:35:47,840 [INFO] 进度: 3400/5980 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 22:35:47,852 [INFO] 进度: 3500/5980 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 22:35:47,865 [INFO] 进度: 3600/5980 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 22:35:47,879 [INFO] 进度: 3700/5980 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 22:35:47,893 [INFO] 进度: 3800/5980 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 22:35:47,906 [INFO] 进度: 3900/5980 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 22:35:47,920 [INFO] 进度: 4000/5980 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 22:35:47,934 [INFO] 进度: 4100/5980 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 22:35:47,947 [INFO] 进度: 4200/5980 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 22:35:47,961 [INFO] 进度: 4300/5980 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 22:35:47,974 [INFO] 进度: 4400/5980 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 22:35:47,988 [INFO] 进度: 4500/5980 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 22:35:48,001 [INFO] 进度: 4600/5980 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 22:35:48,015 [INFO] 进度: 4700/5980 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 22:35:48,029 [INFO] 进度: 4800/5980 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 22:35:48,042 [INFO] 进度: 4900/5980 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 22:35:48,055 [INFO] 进度: 5000/5980 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 22:35:48,069 [INFO] 进度: 5100/5980 (清洗: 0, 去重: 0, 无效: 5100)
2025-11-01 22:35:48,105 [INFO] 进度: 5200/5980 (清洗: 10, 去重: 0, 无效: 5190)
2025-11-01 22:35:48,120 [INFO] 进度: 5300/5980 (清洗: 10, 去重: 0, 无效: 5290)
2025-11-01 22:35:48,133 [INFO] 进度: 5400/5980 (清洗: 10, 去重: 0, 无效: 5390)
2025-11-01 22:35:48,148 [INFO] 进度: 5500/5980 (清洗: 10, 去重: 0, 无效: 5490)
2025-11-01 22:35:48,163 [INFO] 进度: 5600/5980 (清洗: 10, 去重: 0, 无效: 5590)
2025-11-01 22:35:48,180 [INFO] 进度: 5700/5980 (清洗: 10, 去重: 6, 无效: 5684)
2025-11-01 22:35:48,194 [INFO] 进度: 5800/5980 (清洗: 10, 去重: 6, 无效: 5784)
2025-11-01 22:35:48,208 [INFO] 进度: 5900/5980 (清洗: 10, 去重: 6, 无效: 5884)
2025-11-01 22:35:48,219 [INFO] 进度: 5980/5980 (清洗: 10, 去重: 6, 无效: 5964)
2025-11-01 22:35:48,220 [INFO] 
✨ 单次清洗完成
2025-11-01 22:35:48,220 [INFO] 总处理: 5980
2025-11-01 22:35:48,220 [INFO] 清洗成功: 10
2025-11-01 22:35:48,220 [INFO] 去重过滤: 6
2025-11-01 22:35:48,220 [INFO] 无效数据: 5964
2025-11-01 22:35:48,221 [INFO] 
📦 导出清洗结果到文件...
2025-11-01 22:35:48,221 [INFO] 📦 导出 10 条数据到文件...
2025-11-01 22:35:48,229 [INFO] ✅ 数据已导出到: D:\SE\workspace\financial_real_time_trend_analysis\cleaner\output\cleaned_2025-11-01.jsonl
2025-11-01 22:35:48,230 [INFO] 📊 清洗完成，共处理 10 条数据
2025-11-01 22:35:48,230 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 22:35:48,230 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 22:35:48,230 [INFO]   总 ID 数: 141
2025-11-01 22:35:48,231 [INFO]   有效 ID: 10
2025-11-01 22:35:48,231 [INFO]   过期 ID: 131
2025-11-01 22:35:48,231 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 22:35:48,233 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 22:35:48,233 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 22:35:48,233 [INFO] ======================================================================
2025-11-01 22:35:48,233 [INFO] ✨ 数据清洗完成
2025-11-01 22:35:48,233 [INFO] ======================================================================

2025-11-01 22:43:13,445 [INFO] 

⚠️  收到退出信号 (SIGINT)，正在优雅关闭...
2025-11-01 22:43:13,446 [INFO] 
======================================================================
2025-11-01 22:43:13,447 [INFO] 🧹 清理资源...
2025-11-01 22:43:13,447 [INFO] 
🧹 清理 Redis 连接...
2025-11-01 22:43:13,447 [INFO] ✓ 已发送取消订阅请求: crawler_complete
2025-11-01 22:43:13,447 [INFO] ✓ 已断开订阅连接
2025-11-01 22:43:13,448 [INFO] ✓ Redis 订阅连接已关闭
2025-11-01 22:43:13,448 [INFO] ✓ Redis 发送连接已关闭
2025-11-01 22:43:13,448 [INFO] 👋 清洗器已停止
2025-11-01 22:43:13,449 [INFO] ======================================================================
2025-11-01 22:43:39,890 [INFO] ======================================================================
2025-11-01 22:43:39,890 [INFO] 事件驱动清洗器初始化
2025-11-01 22:43:39,891 [INFO] ======================================================================
2025-11-01 22:43:39,891 [INFO] 模式: event_driven
2025-11-01 22:43:39,891 [INFO] 监听频道: crawler_complete (启用: True)
2025-11-01 22:43:39,891 [INFO] 发送频道: cleaner_complete (启用: True)
2025-11-01 22:43:39,891 [INFO] ----------------------------------------------------------------------
2025-11-01 22:43:39,891 [INFO] 去重模式: time_window
2025-11-01 22:43:39,891 [INFO] 时间窗口: 0.01 小时
2025-11-01 22:43:39,891 [INFO] 启动时清空: 否
2025-11-01 22:43:39,891 [INFO] ======================================================================
2025-11-01 22:43:39,892 [INFO] 
======================================================================
2025-11-01 22:43:39,892 [INFO] 🎧 事件驱动数据清洗器已就绪
2025-11-01 22:43:39,892 [INFO] ======================================================================
2025-11-01 22:43:39,892 [INFO] 监听频道: crawler_complete
2025-11-01 22:43:39,892 [INFO] 发送频道: cleaner_complete
2025-11-01 22:43:39,892 [INFO] 按 Ctrl+C 停止
2025-11-01 22:43:39,892 [INFO] ======================================================================

2025-11-01 22:43:39,903 [INFO] ✓ Redis 订阅连接成功: localhost:6379/DB0
2025-11-01 22:43:39,903 [INFO] ✓ 已订阅频道: crawler_complete
2025-11-01 22:43:39,905 [INFO] ✓ Redis 发送连接成功: localhost:6379/DB1
2025-11-01 22:52:16,860 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 22:52:16,860 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 22:52:16,861 [INFO]   总 ID 数: 141
2025-11-01 22:52:16,861 [INFO]   有效 ID: 0
2025-11-01 22:52:16,861 [INFO]   过期 ID: 141
2025-11-01 22:52:16,862 [INFO] 
======================================================================
2025-11-01 22:52:16,862 [INFO] 📬 收到爬虫完成通知
2025-11-01 22:52:16,863 [INFO] ======================================================================
2025-11-01 22:52:16,863 [INFO] 事件类型: crawl_complete
2025-11-01 22:52:16,863 [INFO] 时间戳: 2025-11-01T22:52:16.858630
2025-11-01 22:52:16,863 [INFO] 总数据量: 6096
2025-11-01 22:52:16,863 [INFO] 队列长度: 6096
2025-11-01 22:52:16,863 [INFO] ----------------------------------------------------------------------
2025-11-01 22:52:16,863 [INFO]   reddit: {'posts': 250, 'comments': 4763, 'errors': 0}
2025-11-01 22:52:16,863 [INFO]   newsapi: {'articles': 0, 'errors': 5}
2025-11-01 22:52:16,864 [INFO]   rss: {'articles': 813, 'errors': 0}
2025-11-01 22:52:16,864 [INFO]   stocktwits: {'messages': 270, 'errors': 0}
2025-11-01 22:52:16,864 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 22:52:16,864 [INFO] ======================================================================
2025-11-01 22:52:16,864 [INFO] 🚀 开始执行数据清洗...
2025-11-01 22:52:16,864 [INFO] ======================================================================
2025-11-01 22:52:16,865 [INFO] 
🧹 开始单次清洗...
2025-11-01 22:52:16,867 [INFO] 📊 待清洗数据量: 6096
2025-11-01 22:52:16,881 [INFO] 进度: 100/6096 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 22:52:16,895 [INFO] 进度: 200/6096 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 22:52:16,908 [INFO] 进度: 300/6096 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 22:52:16,922 [INFO] 进度: 400/6096 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 22:52:16,937 [INFO] 进度: 500/6096 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 22:52:16,952 [INFO] 进度: 600/6096 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 22:52:16,965 [INFO] 进度: 700/6096 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 22:52:16,980 [INFO] 进度: 800/6096 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 22:52:16,994 [INFO] 进度: 900/6096 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 22:52:17,008 [INFO] 进度: 1000/6096 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 22:52:17,021 [INFO] 进度: 1100/6096 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 22:52:17,034 [INFO] 进度: 1200/6096 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 22:52:17,049 [INFO] 进度: 1300/6096 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 22:52:17,063 [INFO] 进度: 1400/6096 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 22:52:17,077 [INFO] 进度: 1500/6096 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 22:52:17,090 [INFO] 进度: 1600/6096 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 22:52:17,105 [INFO] 进度: 1700/6096 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 22:52:17,118 [INFO] 进度: 1800/6096 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 22:52:17,133 [INFO] 进度: 1900/6096 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 22:52:17,146 [INFO] 进度: 2000/6096 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 22:52:17,161 [INFO] 进度: 2100/6096 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 22:52:17,173 [INFO] 进度: 2200/6096 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 22:52:17,187 [INFO] 进度: 2300/6096 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 22:52:17,202 [INFO] 进度: 2400/6096 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 22:52:17,215 [INFO] 进度: 2500/6096 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 22:52:17,228 [INFO] 进度: 2600/6096 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 22:52:17,242 [INFO] 进度: 2700/6096 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 22:52:17,256 [INFO] 进度: 2800/6096 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 22:52:17,270 [INFO] 进度: 2900/6096 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 22:52:17,282 [INFO] 进度: 3000/6096 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 22:52:17,296 [INFO] 进度: 3100/6096 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 22:52:17,310 [INFO] 进度: 3200/6096 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 22:52:17,323 [INFO] 进度: 3300/6096 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 22:52:17,336 [INFO] 进度: 3400/6096 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 22:52:17,351 [INFO] 进度: 3500/6096 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 22:52:17,364 [INFO] 进度: 3600/6096 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 22:52:17,377 [INFO] 进度: 3700/6096 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 22:52:17,391 [INFO] 进度: 3800/6096 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 22:52:17,405 [INFO] 进度: 3900/6096 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 22:52:17,418 [INFO] 进度: 4000/6096 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 22:52:17,431 [INFO] 进度: 4100/6096 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 22:52:17,445 [INFO] 进度: 4200/6096 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 22:52:17,460 [INFO] 进度: 4300/6096 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 22:52:17,473 [INFO] 进度: 4400/6096 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 22:52:17,487 [INFO] 进度: 4500/6096 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 22:52:17,500 [INFO] 进度: 4600/6096 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 22:52:17,513 [INFO] 进度: 4700/6096 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 22:52:17,527 [INFO] 进度: 4800/6096 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 22:52:17,541 [INFO] 进度: 4900/6096 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 22:52:17,555 [INFO] 进度: 5000/6096 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 22:52:17,572 [INFO] 进度: 5100/6096 (清洗: 0, 去重: 0, 无效: 5100)
2025-11-01 22:52:17,593 [INFO] 进度: 5200/6096 (清洗: 0, 去重: 10, 无效: 5190)
2025-11-01 22:52:17,608 [INFO] 进度: 5300/6096 (清洗: 0, 去重: 10, 无效: 5290)
2025-11-01 22:52:17,623 [INFO] 进度: 5400/6096 (清洗: 0, 去重: 10, 无效: 5390)
2025-11-01 22:52:17,636 [INFO] 进度: 5500/6096 (清洗: 0, 去重: 10, 无效: 5490)
2025-11-01 22:52:17,651 [INFO] 进度: 5600/6096 (清洗: 0, 去重: 10, 无效: 5590)
2025-11-01 22:52:17,666 [INFO] 进度: 5700/6096 (清洗: 0, 去重: 10, 无效: 5690)
2025-11-01 22:52:17,682 [INFO] 进度: 5800/6096 (清洗: 0, 去重: 16, 无效: 5784)
2025-11-01 22:52:17,697 [INFO] 进度: 5900/6096 (清洗: 0, 去重: 16, 无效: 5884)
2025-11-01 22:52:17,712 [INFO] 进度: 6000/6096 (清洗: 0, 去重: 16, 无效: 5984)
2025-11-01 22:52:17,725 [INFO] 进度: 6096/6096 (清洗: 0, 去重: 16, 无效: 6080)
2025-11-01 22:52:17,725 [INFO] 
✨ 单次清洗完成
2025-11-01 22:52:17,726 [INFO] 总处理: 6096
2025-11-01 22:52:17,726 [INFO] 清洗成功: 0
2025-11-01 22:52:17,726 [INFO] 去重过滤: 16
2025-11-01 22:52:17,726 [INFO] 无效数据: 6080
2025-11-01 22:52:17,726 [INFO] 📊 清洗完成，共处理 0 条数据
2025-11-01 22:52:17,727 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 22:52:17,727 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 22:52:17,727 [INFO]   总 ID 数: 141
2025-11-01 22:52:17,727 [INFO]   有效 ID: 0
2025-11-01 22:52:17,727 [INFO]   过期 ID: 141
2025-11-01 22:52:17,728 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 22:52:17,729 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 22:52:17,730 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 22:52:17,730 [INFO] ======================================================================
2025-11-01 22:52:17,730 [INFO] ✨ 数据清洗完成
2025-11-01 22:52:17,731 [INFO] ======================================================================

2025-11-01 23:10:20,365 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 23:10:20,366 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 23:10:20,366 [INFO]   总 ID 数: 141
2025-11-01 23:10:20,366 [INFO]   有效 ID: 0
2025-11-01 23:10:20,366 [INFO]   过期 ID: 141
2025-11-01 23:10:20,367 [INFO] 
======================================================================
2025-11-01 23:10:20,367 [INFO] 📬 收到爬虫完成通知
2025-11-01 23:10:20,367 [INFO] ======================================================================
2025-11-01 23:10:20,369 [INFO] 事件类型: crawl_complete
2025-11-01 23:10:20,369 [INFO] 时间戳: 2025-11-01T23:10:20.364158
2025-11-01 23:10:20,369 [INFO] 总数据量: 12203
2025-11-01 23:10:20,369 [INFO] 队列长度: 6107
2025-11-01 23:10:20,369 [INFO] ----------------------------------------------------------------------
2025-11-01 23:10:20,369 [INFO]   reddit: {'posts': 500, 'comments': 9537, 'errors': 0}
2025-11-01 23:10:20,370 [INFO]   newsapi: {'articles': 0, 'errors': 10}
2025-11-01 23:10:20,370 [INFO]   rss: {'articles': 1626, 'errors': 0}
2025-11-01 23:10:20,370 [INFO]   stocktwits: {'messages': 540, 'errors': 0}
2025-11-01 23:10:20,370 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 23:10:20,370 [INFO] ======================================================================
2025-11-01 23:10:20,370 [INFO] 🚀 开始执行数据清洗...
2025-11-01 23:10:20,371 [INFO] ======================================================================
2025-11-01 23:10:20,371 [INFO] 
🧹 开始单次清洗...
2025-11-01 23:10:20,374 [INFO] 📊 待清洗数据量: 6107
2025-11-01 23:10:20,389 [INFO] 进度: 100/6107 (清洗: 0, 去重: 0, 无效: 100)
2025-11-01 23:10:20,405 [INFO] 进度: 200/6107 (清洗: 0, 去重: 0, 无效: 200)
2025-11-01 23:10:20,421 [INFO] 进度: 300/6107 (清洗: 0, 去重: 0, 无效: 300)
2025-11-01 23:10:20,436 [INFO] 进度: 400/6107 (清洗: 0, 去重: 0, 无效: 400)
2025-11-01 23:10:20,451 [INFO] 进度: 500/6107 (清洗: 0, 去重: 0, 无效: 500)
2025-11-01 23:10:20,467 [INFO] 进度: 600/6107 (清洗: 0, 去重: 0, 无效: 600)
2025-11-01 23:10:20,481 [INFO] 进度: 700/6107 (清洗: 0, 去重: 0, 无效: 700)
2025-11-01 23:10:20,497 [INFO] 进度: 800/6107 (清洗: 0, 去重: 0, 无效: 800)
2025-11-01 23:10:20,511 [INFO] 进度: 900/6107 (清洗: 0, 去重: 0, 无效: 900)
2025-11-01 23:10:20,525 [INFO] 进度: 1000/6107 (清洗: 0, 去重: 0, 无效: 1000)
2025-11-01 23:10:20,539 [INFO] 进度: 1100/6107 (清洗: 0, 去重: 0, 无效: 1100)
2025-11-01 23:10:20,553 [INFO] 进度: 1200/6107 (清洗: 0, 去重: 0, 无效: 1200)
2025-11-01 23:10:20,567 [INFO] 进度: 1300/6107 (清洗: 0, 去重: 0, 无效: 1300)
2025-11-01 23:10:20,580 [INFO] 进度: 1400/6107 (清洗: 0, 去重: 0, 无效: 1400)
2025-11-01 23:10:20,595 [INFO] 进度: 1500/6107 (清洗: 0, 去重: 0, 无效: 1500)
2025-11-01 23:10:20,609 [INFO] 进度: 1600/6107 (清洗: 0, 去重: 0, 无效: 1600)
2025-11-01 23:10:20,623 [INFO] 进度: 1700/6107 (清洗: 0, 去重: 0, 无效: 1700)
2025-11-01 23:10:20,639 [INFO] 进度: 1800/6107 (清洗: 0, 去重: 0, 无效: 1800)
2025-11-01 23:10:20,654 [INFO] 进度: 1900/6107 (清洗: 0, 去重: 0, 无效: 1900)
2025-11-01 23:10:20,669 [INFO] 进度: 2000/6107 (清洗: 0, 去重: 0, 无效: 2000)
2025-11-01 23:10:20,684 [INFO] 进度: 2100/6107 (清洗: 0, 去重: 0, 无效: 2100)
2025-11-01 23:10:20,699 [INFO] 进度: 2200/6107 (清洗: 0, 去重: 0, 无效: 2200)
2025-11-01 23:10:20,714 [INFO] 进度: 2300/6107 (清洗: 0, 去重: 0, 无效: 2300)
2025-11-01 23:10:20,729 [INFO] 进度: 2400/6107 (清洗: 0, 去重: 0, 无效: 2400)
2025-11-01 23:10:20,744 [INFO] 进度: 2500/6107 (清洗: 0, 去重: 0, 无效: 2500)
2025-11-01 23:10:20,759 [INFO] 进度: 2600/6107 (清洗: 0, 去重: 0, 无效: 2600)
2025-11-01 23:10:20,773 [INFO] 进度: 2700/6107 (清洗: 0, 去重: 0, 无效: 2700)
2025-11-01 23:10:20,787 [INFO] 进度: 2800/6107 (清洗: 0, 去重: 0, 无效: 2800)
2025-11-01 23:10:20,803 [INFO] 进度: 2900/6107 (清洗: 0, 去重: 0, 无效: 2900)
2025-11-01 23:10:20,817 [INFO] 进度: 3000/6107 (清洗: 0, 去重: 0, 无效: 3000)
2025-11-01 23:10:20,831 [INFO] 进度: 3100/6107 (清洗: 0, 去重: 0, 无效: 3100)
2025-11-01 23:10:20,845 [INFO] 进度: 3200/6107 (清洗: 0, 去重: 0, 无效: 3200)
2025-11-01 23:10:20,859 [INFO] 进度: 3300/6107 (清洗: 0, 去重: 0, 无效: 3300)
2025-11-01 23:10:20,873 [INFO] 进度: 3400/6107 (清洗: 0, 去重: 0, 无效: 3400)
2025-11-01 23:10:20,889 [INFO] 进度: 3500/6107 (清洗: 0, 去重: 0, 无效: 3500)
2025-11-01 23:10:20,903 [INFO] 进度: 3600/6107 (清洗: 0, 去重: 0, 无效: 3600)
2025-11-01 23:10:20,917 [INFO] 进度: 3700/6107 (清洗: 0, 去重: 0, 无效: 3700)
2025-11-01 23:10:20,931 [INFO] 进度: 3800/6107 (清洗: 0, 去重: 0, 无效: 3800)
2025-11-01 23:10:20,947 [INFO] 进度: 3900/6107 (清洗: 0, 去重: 0, 无效: 3900)
2025-11-01 23:10:20,962 [INFO] 进度: 4000/6107 (清洗: 0, 去重: 0, 无效: 4000)
2025-11-01 23:10:20,976 [INFO] 进度: 4100/6107 (清洗: 0, 去重: 0, 无效: 4100)
2025-11-01 23:10:20,991 [INFO] 进度: 4200/6107 (清洗: 0, 去重: 0, 无效: 4200)
2025-11-01 23:10:21,006 [INFO] 进度: 4300/6107 (清洗: 0, 去重: 0, 无效: 4300)
2025-11-01 23:10:21,022 [INFO] 进度: 4400/6107 (清洗: 0, 去重: 0, 无效: 4400)
2025-11-01 23:10:21,035 [INFO] 进度: 4500/6107 (清洗: 0, 去重: 0, 无效: 4500)
2025-11-01 23:10:21,051 [INFO] 进度: 4600/6107 (清洗: 0, 去重: 0, 无效: 4600)
2025-11-01 23:10:21,065 [INFO] 进度: 4700/6107 (清洗: 0, 去重: 0, 无效: 4700)
2025-11-01 23:10:21,080 [INFO] 进度: 4800/6107 (清洗: 0, 去重: 0, 无效: 4800)
2025-11-01 23:10:21,094 [INFO] 进度: 4900/6107 (清洗: 0, 去重: 0, 无效: 4900)
2025-11-01 23:10:21,108 [INFO] 进度: 5000/6107 (清洗: 0, 去重: 0, 无效: 5000)
2025-11-01 23:10:21,121 [INFO] 进度: 5100/6107 (清洗: 0, 去重: 0, 无效: 5100)
2025-11-01 23:10:21,143 [INFO] 进度: 5200/6107 (清洗: 0, 去重: 10, 无效: 5190)
2025-11-01 23:10:21,159 [INFO] 进度: 5300/6107 (清洗: 0, 去重: 10, 无效: 5290)
2025-11-01 23:10:21,173 [INFO] 进度: 5400/6107 (清洗: 0, 去重: 10, 无效: 5390)
2025-11-01 23:10:21,189 [INFO] 进度: 5500/6107 (清洗: 0, 去重: 10, 无效: 5490)
2025-11-01 23:10:21,206 [INFO] 进度: 5600/6107 (清洗: 0, 去重: 10, 无效: 5590)
2025-11-01 23:10:21,222 [INFO] 进度: 5700/6107 (清洗: 0, 去重: 10, 无效: 5690)
2025-11-01 23:10:21,240 [INFO] 进度: 5800/6107 (清洗: 0, 去重: 16, 无效: 5784)
2025-11-01 23:10:21,255 [INFO] 进度: 5900/6107 (清洗: 0, 去重: 16, 无效: 5884)
2025-11-01 23:10:21,271 [INFO] 进度: 6000/6107 (清洗: 0, 去重: 16, 无效: 5984)
2025-11-01 23:10:21,285 [INFO] 进度: 6100/6107 (清洗: 0, 去重: 16, 无效: 6084)
2025-11-01 23:10:21,287 [INFO] 进度: 6107/6107 (清洗: 0, 去重: 16, 无效: 6091)
2025-11-01 23:10:21,287 [INFO] 
✨ 单次清洗完成
2025-11-01 23:10:21,287 [INFO] 总处理: 6107
2025-11-01 23:10:21,287 [INFO] 清洗成功: 0
2025-11-01 23:10:21,287 [INFO] 去重过滤: 16
2025-11-01 23:10:21,287 [INFO] 无效数据: 6091
2025-11-01 23:10:21,287 [INFO] 📊 清洗完成，共处理 0 条数据
2025-11-01 23:10:21,288 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 23:10:21,288 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 23:10:21,288 [INFO]   总 ID 数: 141
2025-11-01 23:10:21,288 [INFO]   有效 ID: 0
2025-11-01 23:10:21,289 [INFO]   过期 ID: 141
2025-11-01 23:10:21,289 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 23:10:21,290 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 23:10:21,292 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 23:10:21,292 [INFO] ======================================================================
2025-11-01 23:10:21,292 [INFO] ✨ 数据清洗完成
2025-11-01 23:10:21,292 [INFO] ======================================================================

2025-11-01 23:25:43,838 [INFO] 

⚠️  收到退出信号 (SIGINT)，正在优雅关闭...
2025-11-01 23:25:43,838 [INFO] 
======================================================================
2025-11-01 23:25:43,838 [INFO] 🧹 清理资源...
2025-11-01 23:25:43,838 [INFO] 
🧹 清理 Redis 连接...
2025-11-01 23:25:43,838 [INFO] ✓ 已发送取消订阅请求: crawler_complete
2025-11-01 23:25:43,838 [INFO] ✓ 已断开订阅连接
2025-11-01 23:25:43,838 [INFO] ✓ Redis 订阅连接已关闭
2025-11-01 23:25:43,842 [INFO] ✓ Redis 发送连接已关闭
2025-11-01 23:25:43,842 [INFO] 👋 清洗器已停止
2025-11-01 23:25:43,842 [INFO] ======================================================================
2025-11-01 23:25:47,202 [INFO] ======================================================================
2025-11-01 23:25:47,203 [INFO] 事件驱动清洗器初始化
2025-11-01 23:25:47,203 [INFO] ======================================================================
2025-11-01 23:25:47,204 [INFO] 模式: event_driven
2025-11-01 23:25:47,204 [INFO] 监听频道: crawler_complete (启用: True)
2025-11-01 23:25:47,204 [INFO] 发送频道: cleaner_complete (启用: True)
2025-11-01 23:25:47,204 [INFO] ----------------------------------------------------------------------
2025-11-01 23:25:47,204 [INFO] 去重模式: time_window
2025-11-01 23:25:47,204 [INFO] 时间窗口: 0.01 小时
2025-11-01 23:25:47,204 [INFO] 启动时清空: 否
2025-11-01 23:25:47,204 [INFO] ======================================================================
2025-11-01 23:25:47,206 [INFO] 
======================================================================
2025-11-01 23:25:47,206 [INFO] 🎧 事件驱动数据清洗器已就绪
2025-11-01 23:25:47,206 [INFO] ======================================================================
2025-11-01 23:25:47,206 [INFO] 监听频道: crawler_complete
2025-11-01 23:25:47,206 [INFO] 发送频道: cleaner_complete
2025-11-01 23:25:47,206 [INFO] 按 Ctrl+C 停止
2025-11-01 23:25:47,207 [INFO] ======================================================================

2025-11-01 23:25:47,216 [INFO] ✓ Redis 订阅连接成功: localhost:6379/DB0
2025-11-01 23:25:47,216 [INFO] ✓ 已订阅频道: crawler_complete
2025-11-01 23:25:47,218 [INFO] ✓ Redis 发送连接成功: localhost:6379/DB1
2025-11-01 23:28:24,751 [INFO] 
📊 ID 缓存状态 (清洗前):
2025-11-01 23:28:24,751 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 23:28:24,751 [INFO]   总 ID 数: 141
2025-11-01 23:28:24,751 [INFO]   有效 ID: 0
2025-11-01 23:28:24,753 [INFO]   过期 ID: 141
2025-11-01 23:28:24,753 [INFO] 
======================================================================
2025-11-01 23:28:24,753 [INFO] 📬 收到爬虫完成通知
2025-11-01 23:28:24,753 [INFO] ======================================================================
2025-11-01 23:28:24,753 [INFO] 事件类型: crawl_complete
2025-11-01 23:28:24,753 [INFO] 时间戳: 2025-11-01T23:28:24.748246
2025-11-01 23:28:24,753 [INFO] 总数据量: 18251
2025-11-01 23:28:24,754 [INFO] 队列长度: 6048
2025-11-01 23:28:24,754 [INFO] ----------------------------------------------------------------------
2025-11-01 23:28:24,754 [INFO]   reddit: {'posts': 750, 'comments': 14252, 'errors': 0}
2025-11-01 23:28:24,754 [INFO]   newsapi: {'articles': 0, 'errors': 15}
2025-11-01 23:28:24,754 [INFO]   rss: {'articles': 2439, 'errors': 0}
2025-11-01 23:28:24,754 [INFO]   stocktwits: {'messages': 810, 'errors': 0}
2025-11-01 23:28:24,755 [INFO]   alphavantage: {'items': 0, 'errors': 0}
2025-11-01 23:28:24,755 [INFO] ======================================================================
2025-11-01 23:28:24,755 [INFO] 🚀 开始执行数据清洗...
2025-11-01 23:28:24,755 [INFO] ======================================================================
2025-11-01 23:28:24,756 [INFO] 
🧹 开始单次清洗...
2025-11-01 23:28:24,757 [INFO] 📊 待清洗数据量: 6048
2025-11-01 23:28:24,793 [INFO] 进度: 100/6048 (清洗: 1, 去重: 99, 无效: 0)
2025-11-01 23:28:24,825 [INFO] 进度: 200/6048 (清洗: 1, 去重: 199, 无效: 0)
2025-11-01 23:28:24,877 [INFO] 进度: 300/6048 (清洗: 31, 去重: 269, 无效: 0)
2025-11-01 23:28:24,965 [INFO] 进度: 400/6048 (清洗: 122, 去重: 278, 无效: 0)
2025-11-01 23:28:25,060 [INFO] 进度: 500/6048 (清洗: 222, 去重: 278, 无效: 0)
2025-11-01 23:28:25,149 [INFO] 进度: 600/6048 (清洗: 320, 去重: 280, 无效: 0)
2025-11-01 23:28:25,241 [INFO] 进度: 700/6048 (清洗: 420, 去重: 280, 无效: 0)
2025-11-01 23:28:25,333 [INFO] 进度: 800/6048 (清洗: 520, 去重: 280, 无效: 0)
2025-11-01 23:28:25,423 [INFO] 进度: 900/6048 (清洗: 620, 去重: 280, 无效: 0)
2025-11-01 23:28:25,520 [INFO] 进度: 1000/6048 (清洗: 710, 去重: 290, 无效: 0)
2025-11-01 23:28:25,591 [INFO] 进度: 1100/6048 (清洗: 777, 去重: 323, 无效: 0)
2025-11-01 23:28:25,625 [INFO] 进度: 1200/6048 (清洗: 781, 去重: 419, 无效: 0)
2025-11-01 23:28:25,656 [INFO] 进度: 1300/6048 (清洗: 785, 去重: 515, 无效: 0)
2025-11-01 23:28:25,690 [INFO] 进度: 1400/6048 (清洗: 790, 去重: 610, 无效: 0)
2025-11-01 23:28:25,725 [INFO] 进度: 1500/6048 (清洗: 795, 去重: 705, 无效: 0)
2025-11-01 23:28:25,761 [INFO] 进度: 1600/6048 (清洗: 800, 去重: 800, 无效: 0)
2025-11-01 23:28:25,794 [INFO] 进度: 1700/6048 (清洗: 804, 去重: 896, 无效: 0)
2025-11-01 23:28:25,827 [INFO] 进度: 1800/6048 (清洗: 809, 去重: 991, 无效: 0)
2025-11-01 23:28:25,860 [INFO] 进度: 1900/6048 (清洗: 814, 去重: 1086, 无效: 0)
2025-11-01 23:28:25,892 [INFO] 进度: 2000/6048 (清洗: 817, 去重: 1183, 无效: 0)
2025-11-01 23:28:25,925 [INFO] 进度: 2100/6048 (清洗: 821, 去重: 1279, 无效: 0)
2025-11-01 23:28:25,961 [INFO] 进度: 2200/6048 (清洗: 829, 去重: 1371, 无效: 0)
2025-11-01 23:28:25,993 [INFO] 进度: 2300/6048 (清洗: 832, 去重: 1468, 无效: 0)
2025-11-01 23:28:26,026 [INFO] 进度: 2400/6048 (清洗: 837, 去重: 1563, 无效: 0)
2025-11-01 23:28:26,059 [INFO] 进度: 2500/6048 (清洗: 841, 去重: 1659, 无效: 0)
2025-11-01 23:28:26,091 [INFO] 进度: 2600/6048 (清洗: 846, 去重: 1754, 无效: 0)
2025-11-01 23:28:26,125 [INFO] 进度: 2700/6048 (清洗: 850, 去重: 1850, 无效: 0)
2025-11-01 23:28:26,157 [INFO] 进度: 2800/6048 (清洗: 853, 去重: 1947, 无效: 0)
2025-11-01 23:28:26,190 [INFO] 进度: 2900/6048 (清洗: 857, 去重: 2043, 无效: 0)
2025-11-01 23:28:26,223 [INFO] 进度: 3000/6048 (清洗: 862, 去重: 2138, 无效: 0)
2025-11-01 23:28:26,257 [INFO] 进度: 3100/6048 (清洗: 867, 去重: 2233, 无效: 0)
2025-11-01 23:28:26,289 [INFO] 进度: 3200/6048 (清洗: 870, 去重: 2330, 无效: 0)
2025-11-01 23:28:26,319 [INFO] 进度: 3300/6048 (清洗: 873, 去重: 2427, 无效: 0)
2025-11-01 23:28:26,353 [INFO] 进度: 3400/6048 (清洗: 878, 去重: 2522, 无效: 0)
2025-11-01 23:28:26,386 [INFO] 进度: 3500/6048 (清洗: 882, 去重: 2618, 无效: 0)
2025-11-01 23:28:26,419 [INFO] 进度: 3600/6048 (清洗: 885, 去重: 2715, 无效: 0)
2025-11-01 23:28:26,450 [INFO] 进度: 3700/6048 (清洗: 889, 去重: 2811, 无效: 0)
2025-11-01 23:28:26,484 [INFO] 进度: 3800/6048 (清洗: 894, 去重: 2906, 无效: 0)
2025-11-01 23:28:26,518 [INFO] 进度: 3900/6048 (清洗: 899, 去重: 3001, 无效: 0)
2025-11-01 23:28:26,552 [INFO] 进度: 4000/6048 (清洗: 903, 去重: 3097, 无效: 0)
2025-11-01 23:28:26,584 [INFO] 进度: 4100/6048 (清洗: 907, 去重: 3193, 无效: 0)
2025-11-01 23:28:26,617 [INFO] 进度: 4200/6048 (清洗: 911, 去重: 3289, 无效: 0)
2025-11-01 23:28:26,650 [INFO] 进度: 4300/6048 (清洗: 915, 去重: 3385, 无效: 0)
2025-11-01 23:28:26,682 [INFO] 进度: 4400/6048 (清洗: 919, 去重: 3481, 无效: 0)
2025-11-01 23:28:26,716 [INFO] 进度: 4500/6048 (清洗: 926, 去重: 3574, 无效: 0)
2025-11-01 23:28:26,748 [INFO] 进度: 4600/6048 (清洗: 930, 去重: 3670, 无效: 0)
2025-11-01 23:28:26,783 [INFO] 进度: 4700/6048 (清洗: 934, 去重: 3766, 无效: 0)
2025-11-01 23:28:26,816 [INFO] 进度: 4800/6048 (清洗: 940, 去重: 3860, 无效: 0)
2025-11-01 23:28:26,849 [INFO] 进度: 4900/6048 (清洗: 944, 去重: 3956, 无效: 0)
2025-11-01 23:28:26,886 [INFO] 进度: 5000/6048 (清洗: 949, 去重: 4051, 无效: 0)
2025-11-01 23:28:26,920 [INFO] 进度: 5100/6048 (清洗: 954, 去重: 4146, 无效: 0)
2025-11-01 23:28:26,955 [INFO] 进度: 5200/6048 (清洗: 959, 去重: 4241, 无效: 0)
2025-11-01 23:28:26,990 [INFO] 进度: 5300/6048 (清洗: 965, 去重: 4335, 无效: 0)
2025-11-01 23:28:27,029 [INFO] 进度: 5400/6048 (清洗: 977, 去重: 4423, 无效: 0)
2025-11-01 23:28:27,062 [INFO] 进度: 5500/6048 (清洗: 982, 去重: 4518, 无效: 0)
2025-11-01 23:28:27,100 [INFO] 进度: 5600/6048 (清洗: 990, 去重: 4610, 无效: 0)
2025-11-01 23:28:27,137 [INFO] 进度: 5700/6048 (清洗: 995, 去重: 4705, 无效: 0)
2025-11-01 23:28:27,173 [INFO] 进度: 5800/6048 (清洗: 1001, 去重: 4799, 无效: 0)
2025-11-01 23:28:27,212 [INFO] 进度: 5900/6048 (清洗: 1008, 去重: 4892, 无效: 0)
2025-11-01 23:28:27,246 [INFO] 进度: 6000/6048 (清洗: 1014, 去重: 4986, 无效: 0)
2025-11-01 23:28:27,267 [INFO] 进度: 6048/6048 (清洗: 1023, 去重: 5025, 无效: 0)
2025-11-01 23:28:27,267 [INFO] 
✨ 单次清洗完成
2025-11-01 23:28:27,268 [INFO] 总处理: 6048
2025-11-01 23:28:27,268 [INFO] 清洗成功: 1023
2025-11-01 23:28:27,268 [INFO] 去重过滤: 5025
2025-11-01 23:28:27,268 [INFO] 无效数据: 0
2025-11-01 23:28:27,268 [INFO] 
📦 导出清洗结果到文件...
2025-11-01 23:28:27,269 [INFO] 📦 导出 1023 条数据到文件...
2025-11-01 23:28:27,317 [INFO] ✅ 数据已导出到: D:\SE\workspace\financial_real_time_trend_analysis\cleaner\output\cleaned_2025-11-01.jsonl
2025-11-01 23:28:27,318 [INFO] 📊 清洗完成，共处理 1023 条数据
2025-11-01 23:28:27,319 [INFO] 
📊 ID 缓存状态 (清洗后):
2025-11-01 23:28:27,319 [INFO]   类型: ZSET (时间窗口模式)
2025-11-01 23:28:27,319 [INFO]   总 ID 数: 1164
2025-11-01 23:28:27,320 [INFO]   有效 ID: 1023
2025-11-01 23:28:27,320 [INFO]   过期 ID: 141
2025-11-01 23:28:27,320 [INFO] 📤 准备发送清洗完成通知...
2025-11-01 23:28:27,320 [INFO] 
🧹 清理超过 24 小时的旧数据...
2025-11-01 23:28:27,320 [INFO] 
🗑️  开始清理超过 24 小时的旧数据...
2025-11-01 23:28:27,322 [INFO] 队列 clean_data_queue 当前长度: 1023
2025-11-01 23:28:27,322 [INFO] ✅ 清理完成:
2025-11-01 23:28:27,323 [INFO]    - 检查了 1 条数据
2025-11-01 23:28:27,323 [INFO]    - 删除了 0 条旧数据
2025-11-01 23:28:27,323 [INFO]    - 剩余 1023 条数据
2025-11-01 23:28:27,323 [INFO] 
🔍 准备发送通知 - send_enabled: True, publish_client: True
2025-11-01 23:28:27,324 [INFO] 
📢 清洗完成通知已发送到频道 'cleaner_complete' (1 个订阅者)
2025-11-01 23:28:27,324 [INFO] ======================================================================
2025-11-01 23:28:27,324 [INFO] ✨ 数据清洗完成
2025-11-01 23:28:27,324 [INFO] ======================================================================

2025-11-01 23:31:42,829 [INFO] 

⚠️  收到退出信号 (SIGINT)，正在优雅关闭...
2025-11-01 23:31:42,829 [INFO] 
======================================================================
2025-11-01 23:31:42,832 [INFO] 🧹 清理资源...
2025-11-01 23:31:42,832 [INFO] 
🧹 清理 Redis 连接...
2025-11-01 23:31:42,833 [INFO] ✓ 已发送取消订阅请求: crawler_complete
2025-11-01 23:31:42,833 [INFO] ✓ 已断开订阅连接
2025-11-01 23:31:42,833 [INFO] ✓ Redis 订阅连接已关闭
2025-11-01 23:31:42,834 [INFO] ✓ Redis 发送连接已关闭
2025-11-01 23:31:42,834 [INFO] 👋 清洗器已停止
2025-11-01 23:31:42,834 [INFO] ======================================================================
